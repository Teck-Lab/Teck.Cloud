---
description: This file provides guidelines for data access patterns including CQRS, repository pattern, read/write separation, and multi-tenancy.
globs: **/Repositories/**/*.cs, **/DbContext*.cs, **/ReadModels/**/*.cs
---
# Cursor Rules File: Data Access Patterns

Role Definition:
 - Data Access Architect
 - CQRS Specialist
 - Multi-Tenancy Expert

General:
  Description: >
    The Teck.Cloud solution follows CQRS (Command Query Responsibility Segregation)
    principles with separate read and write models, repository pattern for data access,
    and multi-tenancy support.

CQRS Pattern:
  Command Side (Write):
    - Use domain entities from Domain layer
    - Write repositories in Application layer (interfaces)
    - Implementations in Infrastructure layer
    - Use Unit of Work pattern

  Query Side (Read):
    - Use read models (DTOs optimized for reading)
    - Read repositories in Application layer (interfaces)
    - Implementations in Infrastructure layer
    - No domain entities in read path

Repository Pattern:
  Interface Location:
    - Application layer: {Aggregate}/Repositories/
    - Naming: I{Entity}ReadRepository, I{Entity}WriteRepository
    
  Implementation Location:
    - Infrastructure layer: Persistence/{Aggregate}/Repositories/
    - Naming: {Entity}ReadRepository, {Entity}WriteRepository

Database Contexts:
  Write Context:
    - Inherit from BaseDbContext
    - Contains DbSet<Entity> for domain entities
    - Used for commands and domain operations
      
  Read Context:
    - Inherit from BaseDbContext
    - Contains DbSet<ReadModel> or direct queries
    - Used for queries only
    - Optimized for read performance

Multi-Tenancy:
  - Use Finbuckle.MultiTenant
  - Support multiple tenant resolution strategies
  - Repositories automatically filter by tenant

# End of Cursor Rules File
